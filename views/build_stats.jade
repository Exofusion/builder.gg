doctype html
html
  head
    title= title
    
    link(rel='stylesheet', href='/stylesheets/style.css')
    link(rel='stylesheet', href='/bower_components/bootstrap/dist/css/bootstrap.css')
    link(rel='stylesheet', href='/bower_components/angular-ui-select/dist/select.css')
    link(rel='stylesheet', href='/bower_components/angular-chart.js/dist/angular-chart.css')
    script(src='/bower_components/jquery/dist/jquery.js')
    script(src='https://ajax.googleapis.com/ajax/libs/angularjs/1.4.3/angular.min.js')
    script(src='/bower_components/Chart.js/Chart.js')
    script(src='/bower_components/Chart.StackedBar.js/src/Chart.StackedBar.js')
    script(src='/bower_components/angular-chart.js/dist/angular-chart.js')
    script(src='/bower_components/angular-sanitize/angular-sanitize.min.js')
    script(src='/bower_components/angular-ui-select/dist/select.js')
    script(src='/core.js')

  body(ng-app='coreApp', ng-controller='buildStatsCtrl', class='ng-cloak')
    #statSearchContainer
        form(ng-submit='submit()')
          .col-md-1
          .col-md-2
            ui-select(ng-model="search.tier.selected" theme="bootstrap" ng-disabled="disabled" class="tier_select" search-enabled="false" ng-init='search.tier.selected = tiers[4]')
              ui-select-match(placeholder="Select a tier")
                img(ng-src="{{$select.selected.image}}")
                {{$select.selected.name}}
              ui-select-choices(repeat="tier in tiers")
                .item-selection-choice
                  img(ng-src="{{tier.image}}")
                  span(ng-bind-html="tier.name")

          .col-md-2
            ui-select(ng-model="search.championId.selected" theme="bootstrap" ng-disabled="disabled" class="champion_select" search-enabled="true")
              ui-select-match(placeholder="Enter a champion")
                img(ng-src="{{$select.selected.image}}")
                {{$select.selected.name}}
              ui-select-choices(repeat="champion in champion_array | filter: $select.search")
                .item-selection-choice
                  img(ng-src="{{champion.image}}")
                  span(ng-bind-html="champion.name | highlight: $select.search")

          .col-md-2
            ui-select(ng-model="search.position.selected" theme="bootstrap" ng-disabled="disabled" class="position_select" search-enabled="false")
              ui-select-match(placeholder="Select a position")
                {{$select.selected}}
              ui-select-choices(repeat="position in positions")
                .item-selection-choice
                  span(ng-bind-html="position")

          .col-md-2#victorySelect
            label(class='radio-inline')
              input(type='radio'
                    ng-model='search.victory'
                    value='true'
                    ng-checked='true')
              span Victory

            label(class='radio-inline')
              input(type='radio'
                    ng-model='search.victory'
                    value='false')
              span Defeat

          .col-md-1
            input(type='submit' class='btn btn-default' value='Lookup' ng-show='!alert_loading')
            input(type='submit' class='btn btn-default disabled' ng-show='alert_loading' value="Loading...")

    #alertContainer
      div(class="alert alert-danger" ng-show="alert_error")
        <strong>Error:</strong> {{alert_error_message}}
      div(class="alert alert-success" ng-show="alert_current_match")
        {{alert_current_match_message}}

    #kdaChartContainer.genericContainer
      canvas(id='kdaChart')

    #startEndBuilds.genericContainer
      table(width="100%")
        thead
          tr
            td(width="50%") Start Build
            td(width="50%") Core Build
        tbody
          tr
            td
              span(ng-repeat="item in start_build.items track by $index")
                img(height="50px" width="50px" ng-src="{{getItemImage(item)}}")
              div {{Math.floor(100*(start_build.count/item_builds[0].samples))}}%
            td
              span(ng-repeat="item in core_build track by $index")
                img(height="50px" width="50px" ng-src="{{getItemImage(item)}}")

    #minuteBuilds.genericContainer
      table(width="100%")
        thead
          tr
            td(ng-repeat="n in getNumber(10) track by $index") {{5+($index*5)}}:00
        tbody
          tr
            td(ng-repeat="frame in item_builds track by $index" ng-if="$index > 0 && $index < 11")
              span(ng-repeat="item in frame.significant_purchases")
                img(height="50px" width="50px" ng-src="{{getItemImage(item.id)}}")
                div {{item.popularity}}%
          tr
            td(ng-repeat="frame in item_builds track by $index" ng-if="$index < 11")
              div(ng-repeat="item in item_builds[$index].item_count")
                img(height="30px" width="30px" ng-src="{{getItemImage(item.id)}}")
                span {{item.popularity}}%


    include ./analytics.jade