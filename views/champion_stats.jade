doctype html
html
  head
    title= title
    
    include ./common_includes.jade

  body(ng-app='coreApp', ng-controller='buildStatsCtrl', class='ng-cloak')
    include ./navigation.jade

    #siteHeader.col-md-8
      h1 champion.builder.gg
      #headerSubText
        #randomSelect(class='noselect' ng-click='randomSearch()') How does {{random_tier}} build {{random_lane}} {{random_champion}}?

    #statSearchContainer
      .row
        .col-md-3
        .col-md-2
          ui-select(ng-model="search.tier.selected" theme="bootstrap" ng-disabled="disabled" class="tier_select" search-enabled="false" ng-init='search.tier.selected = tiers[4]')
            ui-select-match(placeholder="Select a tier")
              img(ng-src="{{$select.selected.image}}")
              {{$select.selected.name}}
            ui-select-choices(repeat="tier in tiers")
              .item-selection-choice
                img(ng-src="{{tier.image}}")
                span(ng-bind-html="tier.name")

        .col-md-2
          ui-select(ng-model="search.championId.selected" theme="bootstrap" ng-disabled="disabled" class="champion_select" search-enabled="true")
            ui-select-match(placeholder="Enter a champion")
              img(ng-src="{{$select.selected.image}}")
              {{$select.selected.name}}
            ui-select-choices(repeat="champion in champion_array | filter: $select.search")
              .item-selection-choice
                img(ng-src="{{champion.image}}")
                span(ng-bind-html="champion.name | highlight: $select.search")

        .col-md-2
          ui-select(ng-model="search.position.selected" theme="bootstrap" ng-disabled="disabled" class="position_select" search-enabled="false" ng-init="search.position.selected = positions[4]")
            ui-select-match(placeholder="Select a position")
              {{$select.selected}}
            ui-select-choices(repeat="position in positions")
              .item-selection-choice
                span(ng-bind-html="position")

      .row
        .col-md-5
        .col-md-2#searchSubmit
          div(class='btn btn-default' ng-show='!alert_loading' ng-click='submit()') Summon
          div(class='btn btn-default disabled' ng-show='alert_loading') <img id='loading_icon' src='/images/loading.svg'>
  
    #alertContainer
      div(class="alert alert-danger" ng-show="alert_error")
        <strong>Error:</strong> {{alert_error_message}}

    #kdaChartContainer.genericContainer
      canvas(id='kdaChart')

    #kdaTitleContainer
      div(class="alert alert-success" ng-show="alert_current_match")
        {{alert_current_match_message}}
      //div(class='btn btn-default' ng-show='previous_stats' ng-click='loadPrevious()') Load Previous
      div(class='btn btn-default' ng-disabled='!current_stats.victories' ng-click='parseStatCollection("victories")') Display Victories
      div(class='btn btn-default' ng-disabled='!current_stats.defeats' ng-click='parseStatCollection("defeats")') Display Defeats
      div(class='btn btn-default' ng-disabled='!current_stats' ng-click='parseStatCollection("all")') Display All Games

    #startEndBuilds.genericContainer
      table(width="100%")
        thead
          tr
            td(width="50%") Start Build
            td(width="50%") Core Build
        tbody
          tr
            td
              span(ng-repeat="item in start_build.items track by $index")
                img(height="50px" width="50px" ng-src="{{getItemImage(item)}}")
              div {{Math.floor(100*(start_build.count/item_builds[0].samples))}}%
            td
              span(ng-repeat="item in core_build track by $index")
                img(height="50px" width="50px" ng-src="{{getItemImage(item)}}")
              div
                button(class='btn btn-default'
                       ng-show='!item_builder_link && current_stats'
                       ng-click='getItemBuilderLink()') Get Item Builder Link
                button(class='btn btn-default'
                       ng-show='item_builder_link') View Link
                a(href='{{item_builder_link}}' target='_blank')
                  button(class='btn btn-default'
                         ng-show='item_builder_link') Open Link

    #minuteBuilds.genericContainer
      table(width="100%")
        thead
          tr
            td(ng-repeat="n in getNumber(10) track by $index")
              div {{5+($index*5)}}:00
              div ({{item_builds[$index+1].samples ? item_builds[$index+1].samples : 0}})
        tbody
          tr
            td(ng-repeat="frame in item_builds track by $index" ng-if="$index > 0 && $index < 11")
              span(ng-repeat="item in frame.significant_purchases")
                img(height="50px" width="50px" ng-src="{{getItemImage(item.id)}}")
                div {{item.popularity}}%
          tr
            td(ng-repeat="frame in item_builds track by $index" ng-if="$index > 0 && $index < 11")
              div(ng-repeat="item in item_builds[$index].item_count")
                img(height="30px" width="30px" ng-src="{{getItemImage(item.id)}}")
                span {{item.popularity}}%


    include ./analytics.jade